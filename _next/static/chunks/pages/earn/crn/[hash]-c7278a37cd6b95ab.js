(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return t(33623)}])},33378:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var i=t(85893),a=t(19521),r=t(67294);let l=a.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:t}=e,i=t?n.color.main1:n.color.disabled2;return[{height:"0.75rem",width:"0.5rem"},(0,a.iv)(["background-color:",";"],i)]}),s=e=>{let{decentralization:n}=e,t=e=>(e+1)*.3;return(0,i.jsx)(d,{children:(0,i.jsx)(c,{children:Array.from({length:3},(e,a)=>(0,i.jsx)(l,{$active:n>=t(a)},a))})})};s.displayName="NodeDecentralization";var o=(0,r.memo)(s),d=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},67200:function(e,n,t){"use strict";t.d(n,{d:function(){return a}});var i=t(67294);function a(e){let{nodes:n}=e,t=(0,i.useMemo)(()=>{let e=n||Array.from({length:4},(e,n)=>({metricsData:{as_name:"Provider ".concat(n)}}));return e.reduce((e,n)=>{var t;let i=(null===(t=n.metricsData)||void 0===t?void 0:t.as_name)||"others";return e[i]=(e[i]||0)+1,e},{others:0})},[n]),a=(0,i.useMemo)(()=>Object.values(t).reduce((e,n)=>e+n,0),[t]),r=(0,i.useMemo)(()=>{let e=Object.entries(t).filter(e=>{let[n]=e;return"others"!==n}).sort((e,n)=>{let[,t]=e,[,i]=n;return i-t}),n=e.slice(0,3),i=e.slice(3),r=["others",t.others+i.reduce((e,n)=>{let[,t]=n;return e+t},0)];return[...n,r].map((e,n)=>{let[t,i]=e;return{tier:n+1,name:t,count:i,percentage:i/a,color:0===n?"error":1===n?"main2":2===n?"main0":"main1"}})},[t,a]);return{total:a,buckets:t,top:r}}},33623:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return et}});var i=t(85893),a=t(19521),r=t(67294),l=t(9008),s=t.n(l),o=t(94461),d=t(48107),c=t(11163),m=t(94527),u=t(15457),h=t(58193),p=t(10159),v=t(87536),x=t(56312),f=t(72771),j=t(91421),g=t(73384),_=t(67200),C=t(33358),y=t(34853),w=t(41664),N=t.n(w),S=t(1218),k=t(68390),E=t(68732),D=t(8978),b=t(33378),I=t(77849),P=t(43666),R=t(25675),Z=t.n(R),A=t(7954),O=t(87931);let H=(0,a.ZP)(f.zx).attrs(e=>({...e,forwardedAs:"span",onClick:e=>e.preventDefault(),kind:"neon",size:"lg",variant:"textOnly",color:"main0"})).withConfig({displayName:"styles__StyledInfoTooltipButton",componentId:"sc-1nmv0rk-0"})(()=>[{cursor:"help !important"}]),M=e=>{let{children:n,tooltipContent:t,plain:a,align:l="right",vAlign:s="center",...o}=e,[d,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(!0)},[]);let m=(0,r.useRef)(null),u=(0,f._K)("md"),h=(0,i.jsx)(z,{name:"info-circle",$_css:["left"===l?{order:"-1"}:"","top"===s?{marginBottom:"0.5rem"}:""]});return(0,i.jsxs)(i.Fragment,{children:[a?(0,i.jsxs)(B,{ref:m,children:[n,h]}):(0,i.jsxs)(U,{ref:m,children:[n,h]}),d&&(0,i.jsx)(L,{...o,targetRef:m,content:t,$_css2:u?{position:"fixed !important",left:"0px !important",top:"0px !important",zIndex:"20 !important",margin:"1.5rem",height:"calc(100% - 3rem) !important",width:"calc(100% - 3rem) !important",maxWidth:"100% !important",transform:"none !important"}:{}})]})};M.displayName="InfoTooltipButton";var T=(0,r.memo)(M),z=(0,a.ZP)(f.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-15p503-0"})(["",""],e=>e.$_css),B=(0,a.ZP)("span").withConfig({displayName:"cmp___StyledSpan",componentId:"sc-15p503-1"})({display:"inline-flex",cursor:"help",alignItems:"center",gap:"0.625rem"}),U=(0,a.ZP)(H).withConfig({displayName:"cmp___StyledStyledInfoTooltipButton",componentId:"sc-15p503-2"})({display:"inline-flex",alignItems:"center",gap:"0.625rem"}),L=(0,a.ZP)(f.u).withConfig({displayName:"cmp___StyledTooltip",componentId:"sc-15p503-3"})(["",""],e=>e.$_css2);let F=()=>{var e,n,t;let{node:a,nodesOnSameASN:l,baseLatency:w,lastMetricsCheck:R,calculatedRewards:H,isUserLinked:M,isLinkable:z,creationDate:B,nameCtrl:U,descriptionCtrl:L,bannerCtrl:F,pictureCtrl:W,isOwner:et,isDirty:ei,rewardCtrl:ea,streamRewardCtrl:er,addressCtrl:el,asnTier:es,nodeSpecs:eo,createInstanceUrl:ed,nodeBenchmark:ec,handleRemove:em,handleSubmit:eu,handleLink:eh,handleUnlink:ep}=function(){let e=(0,c.useRouter)(),{hash:n}=e.query,[t]=(0,o.mr)(),{account:i}=t.account,{entities:a}=t.crns,{node:l}=function(e){let{hash:n}=e,[t]=(0,o.mr)(),{entities:i}=t.crns,a=(0,r.useMemo)(()=>{if(i)return i.filter(e=>e.hash===n)},[i,n]),[l]=a||[];return{node:l}}({hash:n}),{userNode:s}=(0,h.h)({}),y=(0,r.useMemo)(()=>new d.B(i),[i]);y.isUserLinked;let{calculatedRewards:w}=(0,m.H)({address:(null==l?void 0:l.reward)||""}),N=(0,u._)({node:l,nodes:a}),S=(0,r.useMemo)(()=>{if(l)return y.isUserLinked(l,s)},[l,y,s]),k=(0,r.useMemo)(()=>{if(l)return y.isLinkable(l,s)[0]},[l,y,s]),{handleLink:E,handleUnlink:D}=(0,g.i)(),b=(0,r.useCallback)(async()=>{if(!l)return;let n=await E(l.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[E,e,l,s]),I=(0,r.useCallback)(async()=>{if(!l)return;let n=await D(l.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[D,e,l,s]),{top:P}=(0,_.d)({nodes:a}),R=P.find(e=>{var n;return e.name===(null==l?void 0:null===(n=l.metricsData)||void 0===n?void 0:n.as_name)}),Z=(0,r.useMemo)(()=>{if(l)return[l]},[l]),{specs:A}=function(e){let{nodes:n}=e,[t]=(0,o.mr)(),{account:i}=t.account,a=(0,r.useMemo)(()=>new d.B(i),[i]),[l,s]=(0,r.useState)({}),[c,m]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async function(){n&&(await Promise.allSettled(n.map(async e=>{let n=await a.getCRNspecs(e);s(t=>({...t,[e.hash]:{data:n,loading:!1,error:void 0}}))})),m(!1))})()},[a,n]),{specs:l,loading:c}}({nodes:Z}),O=(0,r.useMemo)(()=>{var e;if(l)return null===(e=A[l.hash])||void 0===e?void 0:e.data},[A,l]),H=(0,r.useMemo)(()=>{if(l&&y.isStreamPaymentSupported(l))return"".concat(C.RG,"/").concat(l.hash)},[l,y]),{benchmark:M}=function(e){let{nodes:n}=e,[t]=(0,o.mr)(),{account:i}=t.account,a=(0,r.useMemo)(()=>new d.B(i),[i]),[l,s]=(0,r.useState)({}),[c,m]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async function(){n&&(await Promise.allSettled(n.map(async e=>{let n=await a.getCRNBenchmark(e);s(t=>({...t,[e.hash]:{data:n,loading:!1,error:void 0}}))})),m(!1))})()},[a,n]),{benchmark:l,loading:c}}({nodes:Z}),T=(0,r.useMemo)(()=>{var e;if(l)return null===(e=M[l.hash])||void 0===e?void 0:e.data},[M,l]),z=(0,r.useMemo)(()=>({hash:null==l?void 0:l.hash,name:null==l?void 0:l.name,description:null==l?void 0:l.description,reward:null==l?void 0:l.reward,stream_reward:null==l?void 0:l.stream_reward,authorized:null==l?void 0:l.authorized,locked:null==l?void 0:l.locked,registration_url:null==l?void 0:l.registration_url,picture:null==l?void 0:l.picture,banner:null==l?void 0:l.banner,address:null==l?void 0:l.address}),[l]),B=function(e){let{defaultValues:n}=e,[t,i]=(0,o.mr)(),{account:a}=t.account,{entities:l}=t.crns,s=(0,f.lm)(),c=(0,r.useMemo)(()=>new d.B(a),[a]),m=(0,r.useCallback)(async e=>{if(!c)throw Error("Manager not ready");if(!a)throw Error("Invalid account");let[,n]=await c.updateComputeResourceNode(e),t=null==l?void 0:l.find(e=>e.hash===n.hash),i=function(e,n){let t={...e||{},...n,virtual:Date.now()};return t}(t,n);return i},[a,c,l]),u=(0,r.useCallback)(async e=>{if(!s)throw Error("Notification not ready");s.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),i(new j.Wy({name:"crns",entities:[e]}))},[i,s]),{control:h,handleSubmit:g,formState:{errors:_,isDirty:C}}=(0,p.c)({defaultValues:n,onSubmit:m,onSuccess:u,resolver:(0,x.F)(d.B.updateCRNSchema),readyDeps:[n]}),y=(0,v.qo)({control:h}),w=(0,v.bc)({control:h,name:"name"}),N=(0,v.bc)({control:h,name:"description"}),S=(0,v.bc)({control:h,name:"address"}),k=(0,v.bc)({control:h,name:"picture"}),E=(0,v.bc)({control:h,name:"banner"}),D=(0,v.bc)({control:h,name:"reward"}),b=(0,v.bc)({control:h,name:"stream_reward"}),I=(0,v.bc)({control:h,name:"authorized"}),P=(0,v.bc)({control:h,name:"locked"}),R=(0,v.bc)({control:h,name:"registration_url"});return{values:y,control:h,nameCtrl:w,descriptionCtrl:N,addressCtrl:S,pictureCtrl:k,bannerCtrl:E,rewardCtrl:D,streamRewardCtrl:b,authorizedCtrl:I,lockedCtrl:P,registrationUrlCtrl:R,errors:_,isDirty:C,handleSubmit:g}}({defaultValues:z});return{nodes:a,node:l,userNode:s,calculatedRewards:w,isUserLinked:S,isLinkable:k,asnTier:R,nodeSpecs:O,createInstanceUrl:H,nodeBenchmark:T,handleLink:b,handleUnlink:I,...B,...N}}();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s(),{children:[(0,i.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,i.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,i.jsx)("section",{children:(0,i.jsx)(S.Z,{node:a,nameCtrl:U,descriptionCtrl:L,bannerCtrl:F,pictureCtrl:W,isOwner:et})}),et&&(0,i.jsxs)(J,{children:[(0,i.jsxs)(f.zx,{kind:"flat",variant:"textOnly",size:"md",color:"error",onClick:em,children:[(0,i.jsx)(f.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,i.jsx)(f.zx,{kind:"neon",variant:"primary",size:"md",color:"main2",onClick:eu,disabled:!ei,children:"save changes"})]}),(0,i.jsx)(K,{children:(0,i.jsxs)(E.Z,{children:[(0,i.jsx)("div",{children:(0,i.jsxs)(k.ZP,{title:"GENERAL INFO",children:[(0,i.jsx)(D.Z,{status:null==a?void 0:a.status}),(0,i.jsx)(k.HC,{name:"NAME",value:null==a?void 0:a.name}),(0,i.jsx)(k.HC,{name:"ASN",value:null==a?void 0:null===(e=a.metricsData)||void 0===e?void 0:e.as_name}),(0,i.jsx)(k.HC,{name:"OWNER",value:(0,i.jsx)(P.Z,{href:(0,y.tz)({address:null==a?void 0:a.owner}),isOwner:!1,children:(null==a?void 0:a.owner)&&(0,y.zN)(null==a?void 0:a.owner)}),big:!0}),(0,i.jsx)(k.HC,{name:"REWARD ADDRESS",value:(0,i.jsx)(I.Z,{...ea.field,...ea.fieldState,placeholder:"reward address",isOwner:et,children:(0,i.jsx)(P.Z,{href:(0,y.tz)({tokenAddress:ea.field.value}),isOwner:et,children:ea.field.value&&(0,y.zN)(ea.field.value)})}),big:!0}),(0,i.jsx)(k.HC,{name:"STREAM REWARD ADDRESS",value:(0,i.jsx)(I.Z,{...er.field,...er.fieldState,placeholder:"PAYG reward address",isOwner:et,children:(0,i.jsx)(P.Z,{href:(0,y.gl)({tokenAddress:er.field.value}),isOwner:et,children:er.field.value&&(0,y.zN)(er.field.value)})}),big:!0}),(0,i.jsx)(k.HC,{name:"ADDRESS",value:(0,i.jsx)(I.Z,{...el.field,...el.fieldState,placeholder:"address",isOwner:et,children:(0,i.jsx)(P.Z,{href:null==a?void 0:a.address,isOwner:et,children:null==a?void 0:a.address})}),big:!0})]})}),(0,i.jsx)("div",{children:(0,i.jsxs)(k.ZP,{title:"HARDWARE",children:[(0,i.jsx)(k.HC,{name:"CPU",value:null==eo?void 0:eo.properties.cpu.vendor}),(0,i.jsx)(k.HC,{name:"CPU ARCHITECTURE",value:null==eo?void 0:eo.properties.cpu.architecture}),(0,i.jsx)(k.HC,{name:"CPU COUNT",value:null==eo?void 0:eo.cpu.count}),(0,i.jsx)(k.HC,{name:"CPU FREQUENCY",value:"".concat((((null==eo?void 0:eo.cpu.core_frequencies.max)||0)/1024).toFixed(2)," GHz")}),(0,i.jsx)(k.HC,{name:"CPU SPEED",value:(null==ec?void 0:ec.cpu.benchmark.average)&&(0,i.jsxs)(T,{plain:!0,my:"top-left",at:"top-right",tooltipContent:(0,i.jsx)("div",{className:"text-left tp-body1 fs-18",children:(0,i.jsx)("div",{children:"CPU SPEED"})}),children:[null==ec?void 0:ec.cpu.benchmark.average.toFixed(1),"s"]})}),(0,i.jsx)(k.HC,{name:"RAM",value:(0,y.eB)(null==eo?void 0:eo.mem.total_kB,"KiB")}),(0,i.jsx)(k.HC,{name:"RAM SPEED",value:(null==ec?void 0:ec.ram.speed)&&(0,i.jsxs)(T,{plain:!0,my:"top-left",at:"top-right",tooltipContent:(0,i.jsx)("div",{className:"text-left tp-body1 fs-18",children:(0,i.jsx)("div",{children:"RAM SPEED"})}),children:[(0,y.eB)((null==ec?void 0:ec.ram.speed)||0,"MiB"),"/s"]})}),(0,i.jsx)(k.HC,{name:"HDD",value:(0,y.eB)(null==eo?void 0:eo.disk.total_kB,"KiB")}),ed&&(0,i.jsx)(Y,{children:(0,i.jsx)(O.Z,{href:ed,target:"_blank",kind:"neon",variant:"primary",size:"md",children:"Create Instance"})})]})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(k.ZP,{title:"REWARD INDICATORS",children:[(0,i.jsx)(k.HC,{name:"NODES ON ASN",value:(0,i.jsxs)($,{className:es&&"text-".concat(es.color),children:[l,!!es&&(0,i.jsx)(f.JO,{name:"hexagon-exclamation",color:es.color})]})}),(0,i.jsx)(k.HC,{name:"VERSION",value:null==a?void 0:null===(n=a.metricsData)||void 0===n?void 0:n.version}),(0,i.jsx)(k.HC,{name:"BASE LATENCY",value:w}),(0,i.jsx)(k.HC,{name:"LAST CHECK",value:R})]}),(0,i.jsx)(k.ZP,{title:"POTENTIAL REWARD",children:(0,i.jsx)(k.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,i.jsx)(A.Z,{value:H})})})]}),(0,i.jsx)("div",{children:(0,i.jsx)(k.ZP,{title:"LINKED CORE NODE",children:(null==a?void 0:a.parentData)?(0,i.jsxs)(V,{children:[(0,i.jsx)(N(),{href:"/earn/ccn/".concat(a.parentData.hash),legacyBehavior:!0,children:(0,i.jsx)(ee,{hash:a.parentData.hash,name:a.parentData.name,picture:a.parentData.picture,apiServer:C.pf,ImageCmp:Z()})}),M?(0,i.jsx)("button",{onClick:ep,children:(0,i.jsx)(f.JO,{name:"trash",color:"error"})}):(0,i.jsx)(i.Fragment,{})]}):(0,i.jsxs)(G,{children:[(0,i.jsx)(q,{}),(0,i.jsx)(X,{className:"fs-10",children:!M&&z?(0,i.jsx)(f.zx,{color:"main2",size:"md",kind:"neon",variant:"textOnly",onClick:eh,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(Q,{name:"link"})," link now"]})}):(0,i.jsx)(i.Fragment,{children:"not linked"})})]})})}),(0,i.jsx)("div",{children:(0,i.jsxs)(k.ZP,{title:"DECENTRALIZED SCORE",children:[(0,i.jsxs)(en,{className:es&&"text-".concat(es.color),children:[(0,i.jsx)(b.Z,{decentralization:(null==a?void 0:null===(t=a.scoreData)||void 0===t?void 0:t.decentralization)||0}),!!es&&(0,i.jsx)(f.JO,{name:"hexagon-exclamation",color:es.color})]}),!!es&&(0,i.jsxs)("p",{className:"tp-body3 fs-10",children:["There are ",l," nodes on this ASN. Please consider to migrate your node to a different ASN."]})]})}),(0,i.jsx)("div",{children:(0,i.jsx)(k.ZP,{title:"PERFORMANCE",children:(0,i.jsx)(k.HC,{name:"CREATION TIME",value:B})})})]})})]})};F.displayName="ComputeResourceNodeDetailPage";var W=(0,r.memo)(F),J=(0,a.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),K=(0,a.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),Y=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({paddingTop:"1.5rem",textAlign:"center"}),$=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({display:"flex",alignItems:"center",gap:"0.75rem"}),G=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),q=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),X=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-6"})({lineHeight:"1rem"}),Q=(0,a.ZP)(f.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-7"})({height:"0.875rem",width:"0.875rem"}),V=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-8"})({display:"flex",alignItems:"center"}),ee=(0,a.ZP)(f.tJ).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-9"})({marginRight:"auto",width:"auto",cursor:"pointer"}),en=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-b9jk28-10"})({display:"flex",alignItems:"center",gap:"0.75rem"}),et=W}},function(e){e.O(0,[959,312,505,604,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);