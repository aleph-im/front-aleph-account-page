(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(97172)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return o}});var a=i(85893),r=i(19521),t=i(67294);let l=r.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,a=i?n.color.main1:n.color.disabled2;return[{height:"0.75rem",width:"0.5rem"},(0,r.iv)(["background-color:",";"],a)]}),s=e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,a.jsx)(d,{children:(0,a.jsx)(c,{children:Array.from({length:3},(e,r)=>(0,a.jsx)(l,{$active:n>=i(r)},r))})})};s.displayName="NodeDecentralization";var o=(0,t.memo)(s),d=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},67200:function(e,n,i){"use strict";i.d(n,{d:function(){return r}});var a=i(67294);function r(e){let{nodes:n}=e,i=(0,a.useMemo)(()=>{let e=n||Array.from({length:4},(e,n)=>({metricsData:{as_name:"Provider ".concat(n)}}));return e.reduce((e,n)=>{var i;let a=(null===(i=n.metricsData)||void 0===i?void 0:i.as_name)||"others";return e[a]=(e[a]||0)+1,e},{others:0})},[n]),r=(0,a.useMemo)(()=>Object.values(i).reduce((e,n)=>e+n,0),[i]),t=(0,a.useMemo)(()=>{let e=Object.entries(i).filter(e=>{let[n]=e;return"others"!==n}).sort((e,n)=>{let[,i]=e,[,a]=n;return a-i}),n=e.slice(0,3),a=e.slice(3),t=["others",i.others+a.reduce((e,n)=>{let[,i]=n;return e+i},0)];return[...n,t].map((e,n)=>{let[i,a]=e;return{tier:n+1,name:i,count:a,percentage:a/r,color:0===n?"error":1===n?"main2":2===n?"main0":"main1"}})},[i,r]);return{total:r,buckets:i,top:t}}},96264:function(e,n,i){"use strict";i.d(n,{O:function(){return l}});var a=i(67294),r=i(48107),t=i(94461);function l(e){let{nodes:n}=e,[i]=(0,t.mr)(),{account:l}=i.account,s=(0,a.useMemo)(()=>new r.B(l),[l]),[o,d]=(0,a.useState)({}),[c,u]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async function(){n&&(await Promise.allSettled(n.map(async e=>{let n=await s.getCRNspecs(e);d(i=>({...i,[e.hash]:{data:n,loading:!1,error:void 0}}))})),u(!1))})()},[s,n]),{specs:o,loading:c}}},97172:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return K}});var a=i(85893),r=i(19521),t=i(67294),l=i(9008),s=i.n(l),o=i(94461),d=i(48107),c=i(11163),u=i(94527),m=i(15457),h=i(58193),v=i(10159),p=i(87536),x=i(56312),f=i(72771),j=i(91421),C=i(73384),_=i(67200),w=i(96264),g=i(33358),N=i(34853),y=i(41664),k=i.n(y),D=i(1218),E=i(68390),S=i(68732),b=i(8978),R=i(33378),A=i(77849),I=i(43666),O=i(25675),P=i.n(O),Z=i(7954);let H=()=>{var e,n,i;let{node:r,nodesOnSameASN:l,baseLatency:y,lastMetricsCheck:O,calculatedRewards:H,isUserLinked:M,isLinkable:K,creationDate:q,nameCtrl:X,descriptionCtrl:Q,bannerCtrl:V,pictureCtrl:$,isOwner:ee,isDirty:en,rewardCtrl:ei,streamRewardCtrl:ea,addressCtrl:er,asnTier:et,nodeSpecs:el,handleRemove:es,handleSubmit:eo,handleLink:ed,handleUnlink:ec}=function(){let e=(0,c.useRouter)(),{hash:n}=e.query,[i]=(0,o.mr)(),{account:a}=i.account,{entities:r}=i.crns,{node:l}=function(e){let{hash:n}=e,[i]=(0,o.mr)(),{entities:a}=i.crns,r=(0,t.useMemo)(()=>{if(a)return a.filter(e=>e.hash===n)},[a,n]),[l]=r||[];return{node:l}}({hash:n}),{userNode:s}=(0,h.h)({}),N=(0,t.useMemo)(()=>new d.B(a),[a]);N.isUserLinked;let{calculatedRewards:y}=(0,u.H)({address:(null==l?void 0:l.reward)||""}),k=(0,m._)({node:l,nodes:r}),D=(0,t.useMemo)(()=>{if(l)return N.isUserLinked(l,s)},[l,N,s]),E=(0,t.useMemo)(()=>{if(l)return N.isLinkable(l,s)[0]},[l,N,s]),{handleLink:S,handleUnlink:b}=(0,C.i)(),R=(0,t.useCallback)(async()=>{if(!l)return;let n=await S(l.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[S,e,l,s]),A=(0,t.useCallback)(async()=>{if(!l)return;let n=await b(l.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[b,e,l,s]),{top:I}=(0,_.d)({nodes:r}),O=I.find(e=>{var n;return e.name===(null==l?void 0:null===(n=l.metricsData)||void 0===n?void 0:n.as_name)}),P=(0,t.useMemo)(()=>{if(l)return[l]},[l]),{specs:Z}=(0,w.O)({nodes:P}),H=(0,t.useMemo)(()=>{var e;if(l)return null===(e=Z[l.hash])||void 0===e?void 0:e.data},[Z,l]),M=(0,t.useMemo)(()=>{if(l&&!N.isStreamPaymentNotSupported(l))return"".concat(g.RG,"/").concat(l.hash)},[l,N]),T=(0,t.useMemo)(()=>({hash:null==l?void 0:l.hash,name:null==l?void 0:l.name,description:null==l?void 0:l.description,reward:null==l?void 0:l.reward,stream_reward:null==l?void 0:l.stream_reward,authorized:null==l?void 0:l.authorized,locked:null==l?void 0:l.locked,registration_url:null==l?void 0:l.registration_url,picture:null==l?void 0:l.picture,banner:null==l?void 0:l.banner,address:null==l?void 0:l.address}),[l]),z=function(e){let{defaultValues:n}=e,[i,a]=(0,o.mr)(),{account:r}=i.account,{entities:l}=i.crns,s=(0,f.lm)(),c=(0,t.useMemo)(()=>new d.B(r),[r]),u=(0,t.useCallback)(async e=>{if(!c)throw Error("Manager not ready");if(!r)throw Error("Invalid account");let[,n]=await c.updateComputeResourceNode(e),i=null==l?void 0:l.find(e=>e.hash===n.hash),a=function(e,n){let i={...e||{},...n,virtual:Date.now()};return i}(i,n);return a},[r,c,l]),m=(0,t.useCallback)(async e=>{if(!s)throw Error("Notification not ready");s.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),a(new j.Wy({name:"crns",entities:[e]}))},[a,s]),{control:h,handleSubmit:C,formState:{errors:_,isDirty:w}}=(0,v.c)({defaultValues:n,onSubmit:u,onSuccess:m,resolver:(0,x.F)(d.B.updateCRNSchema),readyDeps:[n]}),g=(0,p.qo)({control:h}),N=(0,p.bc)({control:h,name:"name"}),y=(0,p.bc)({control:h,name:"description"}),k=(0,p.bc)({control:h,name:"address"}),D=(0,p.bc)({control:h,name:"picture"}),E=(0,p.bc)({control:h,name:"banner"}),S=(0,p.bc)({control:h,name:"reward"}),b=(0,p.bc)({control:h,name:"stream_reward"}),R=(0,p.bc)({control:h,name:"authorized"}),A=(0,p.bc)({control:h,name:"locked"}),I=(0,p.bc)({control:h,name:"registration_url"});return{values:g,control:h,nameCtrl:N,descriptionCtrl:y,addressCtrl:k,pictureCtrl:D,bannerCtrl:E,rewardCtrl:S,streamRewardCtrl:b,authorizedCtrl:R,lockedCtrl:A,registrationUrlCtrl:I,errors:_,isDirty:w,handleSubmit:C}}({defaultValues:T});return{nodes:r,node:l,userNode:s,calculatedRewards:y,isUserLinked:D,isLinkable:E,asnTier:O,nodeSpecs:H,createInstanceUrl:M,handleLink:R,handleUnlink:A,...z,...k}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,a.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,a.jsx)("section",{children:(0,a.jsx)(D.Z,{node:r,nameCtrl:X,descriptionCtrl:Q,bannerCtrl:V,pictureCtrl:$,isOwner:ee})}),ee&&(0,a.jsxs)(T,{children:[(0,a.jsxs)(f.zx,{kind:"flat",variant:"textOnly",size:"md",color:"error",onClick:es,children:[(0,a.jsx)(f.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,a.jsx)(f.zx,{kind:"neon",variant:"primary",size:"md",color:"main2",onClick:eo,disabled:!en,children:"save changes"})]}),(0,a.jsx)(z,{children:(0,a.jsxs)(S.Z,{children:[(0,a.jsx)("div",{children:(0,a.jsxs)(E.ZP,{title:"GENERAL INFO",children:[(0,a.jsx)(b.Z,{status:null==r?void 0:r.status}),(0,a.jsx)(E.HC,{name:"NAME",value:null==r?void 0:r.name}),(0,a.jsx)(E.HC,{name:"ASN",value:null==r?void 0:null===(e=r.metricsData)||void 0===e?void 0:e.as_name}),(0,a.jsx)(E.HC,{name:"OWNER",value:(0,a.jsx)(I.Z,{href:(0,N.tz)({address:null==r?void 0:r.owner}),isOwner:!1,children:(null==r?void 0:r.owner)&&(0,N.zN)(null==r?void 0:r.owner)}),big:!0}),(0,a.jsx)(E.HC,{name:"REWARD ADDRESS",value:(0,a.jsx)(A.Z,{...ei.field,...ei.fieldState,placeholder:"reward address",isOwner:ee,children:(0,a.jsx)(I.Z,{href:(0,N.tz)({tokenAddress:ei.field.value}),isOwner:ee,children:ei.field.value&&(0,N.zN)(ei.field.value)})}),big:!0}),(0,a.jsx)(E.HC,{name:"STREAM REWARD ADDRESS",value:(0,a.jsx)(A.Z,{...ea.field,...ea.fieldState,placeholder:"PAYG reward address",isOwner:ee,children:(0,a.jsx)(I.Z,{href:(0,N.gl)({tokenAddress:ea.field.value}),isOwner:ee,children:ea.field.value&&(0,N.zN)(ea.field.value)})}),big:!0}),(0,a.jsx)(E.HC,{name:"ADDRESS",value:(0,a.jsx)(A.Z,{...er.field,...er.fieldState,placeholder:"address",isOwner:ee,children:(0,a.jsx)(I.Z,{href:null==r?void 0:r.address,isOwner:ee,children:null==r?void 0:r.address})}),big:!0})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)(E.ZP,{title:"HARDWARE",children:[(0,a.jsx)(E.HC,{name:"CPU",value:null==el?void 0:el.properties.cpu.vendor}),(0,a.jsx)(E.HC,{name:"CPU ARCHITECTURE",value:null==el?void 0:el.properties.cpu.architecture}),(0,a.jsx)(E.HC,{name:"CPU COUNT",value:null==el?void 0:el.cpu.count}),(0,a.jsx)(E.HC,{name:"CPU FREQUENCY",value:"".concat((((null==el?void 0:el.cpu.core_frequencies.max)||0)/1024).toFixed(2)," GHz")}),(0,a.jsx)(E.HC,{name:"RAM",value:(0,N.eB)(null==el?void 0:el.mem.total_kB,"KiB")}),(0,a.jsx)(E.HC,{name:"HDD",value:(0,N.eB)(null==el?void 0:el.disk.total_kB,"KiB")})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(E.ZP,{title:"REWARD INDICATORS",children:[(0,a.jsx)(E.HC,{name:"NODES ON ASN",value:(0,a.jsxs)(B,{className:et&&"text-".concat(et.color),children:[l,!!et&&(0,a.jsx)(f.JO,{name:"hexagon-exclamation",color:et.color})]})}),(0,a.jsx)(E.HC,{name:"VERSION",value:null==r?void 0:null===(n=r.metricsData)||void 0===n?void 0:n.version}),(0,a.jsx)(E.HC,{name:"BASE LATENCY",value:y}),(0,a.jsx)(E.HC,{name:"LAST CHECK",value:O})]}),(0,a.jsx)(E.ZP,{title:"POTENTIAL REWARD",children:(0,a.jsx)(E.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,a.jsx)(Z.Z,{value:H})})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(E.ZP,{title:"LINKED CORE NODE",children:(null==r?void 0:r.parentData)?(0,a.jsxs)(J,{children:[(0,a.jsx)(k(),{href:"/earn/ccn/".concat(r.parentData.hash),legacyBehavior:!0,children:(0,a.jsx)(Y,{hash:r.parentData.hash,name:r.parentData.name,picture:r.parentData.picture,apiServer:g.pf,ImageCmp:P()})}),M?(0,a.jsx)("button",{onClick:ec,children:(0,a.jsx)(f.JO,{name:"trash",color:"error"})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)(L,{children:[(0,a.jsx)(U,{}),(0,a.jsx)(F,{className:"fs-10",children:!M&&K?(0,a.jsx)(f.zx,{color:"main2",size:"md",kind:"neon",variant:"textOnly",onClick:ed,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(W,{name:"link"})," link now"]})}):(0,a.jsx)(a.Fragment,{children:"not linked"})})]})})}),(0,a.jsx)("div",{children:(0,a.jsxs)(E.ZP,{title:"DECENTRALIZED SCORE",children:[(0,a.jsxs)(G,{className:et&&"text-".concat(et.color),children:[(0,a.jsx)(R.Z,{decentralization:(null==r?void 0:null===(i=r.scoreData)||void 0===i?void 0:i.decentralization)||0}),!!et&&(0,a.jsx)(f.JO,{name:"hexagon-exclamation",color:et.color})]}),!!et&&(0,a.jsxs)("p",{className:"tp-body3 fs-10",children:["There are ",l," nodes on this ASN. Please consider to migrate your node to a different ASN."]})]})}),(0,a.jsx)("div",{children:(0,a.jsx)(E.ZP,{title:"PERFORMANCE",children:(0,a.jsx)(E.HC,{name:"CREATION TIME",value:q})})})]})})]})};H.displayName="ComputeResourceNodeDetailPage";var M=(0,t.memo)(H),T=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),z=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),B=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({display:"flex",alignItems:"center",gap:"0.75rem"}),L=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),U=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),F=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({lineHeight:"1rem"}),W=(0,r.ZP)(f.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-6"})({height:"0.875rem",width:"0.875rem"}),J=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-7"})({display:"flex",alignItems:"center"}),Y=(0,r.ZP)(f.tJ).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-8"})({marginRight:"auto",width:"auto",cursor:"pointer"}),G=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-9"})({display:"flex",alignItems:"center",gap:"0.75rem"}),K=M}},function(e){e.O(0,[959,312,505,331,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);