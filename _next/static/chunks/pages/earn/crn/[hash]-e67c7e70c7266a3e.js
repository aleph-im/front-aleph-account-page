(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(55089)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return o}});var r=i(85893),t=i(19521),a=i(67294);let s=t.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,r=i?n.color.main1:n.color.disabled2;return[{height:"0.75rem",width:"0.5rem"},(0,t.iv)(["background-color:",";"],r)]}),l=e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,r.jsx)(d,{children:(0,r.jsx)(c,{children:Array.from({length:3},(e,t)=>(0,r.jsx)(s,{$active:n>=i(t)},t))})})};l.displayName="NodeDecentralization";var o=(0,a.memo)(l),d=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},67200:function(e,n,i){"use strict";i.d(n,{d:function(){return t}});var r=i(67294);function t(e){let{nodes:n}=e,i=(0,r.useMemo)(()=>{let e=n||Array.from({length:4},(e,n)=>({metricsData:{as_name:"Provider ".concat(n)}}));return e.reduce((e,n)=>{var i;let r=(null===(i=n.metricsData)||void 0===i?void 0:i.as_name)||"others";return e[r]=(e[r]||0)+1,e},{others:0})},[n]),t=(0,r.useMemo)(()=>Object.values(i).reduce((e,n)=>e+n,0),[i]),a=(0,r.useMemo)(()=>{let e=Object.entries(i).filter(e=>{let[n]=e;return"others"!==n}).sort((e,n)=>{let[,i]=e,[,r]=n;return r-i}),n=e.slice(0,3),r=e.slice(3),a=["others",i.others+r.reduce((e,n)=>{let[,i]=n;return e+i},0)];return[...n,a].map((e,n)=>{let[i,r]=e;return{tier:n+1,name:i,count:r,percentage:r/t,color:0===n?"error":1===n?"main2":2===n?"main0":"main1"}})},[i,t]);return{total:t,buckets:i,top:a}}},96264:function(e,n,i){"use strict";i.d(n,{O:function(){return s}});var r=i(67294),t=i(48107),a=i(94461);function s(e){let{nodes:n}=e,[i]=(0,a.mr)(),{account:s}=i.account,l=(0,r.useMemo)(()=>new t.B(s),[s]),[o,d]=(0,r.useState)({}),[c,m]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async function(){n&&(await Promise.allSettled(n.map(async e=>{let n=await l.getCRNspecs(e);d(i=>({...i,[e.hash]:{data:n,loading:!1,error:void 0}}))})),m(!1))})()},[l,n]),{specs:o,loading:c}}},55089:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return ei}});var r=i(85893),t=i(19521),a=i(67294),s=i(9008),l=i.n(s),o=i(94461),d=i(48107),c=i(11163),m=i(94527),u=i(15457),h=i(58193),p=i(10159),v=i(87536),f=i(56312),x=i(72771),j=i(91421),g=i(73384),y=i(67200),_=i(96264),C=i(33358),w=i(34853),N=i(41664),b=i.n(N),S=i(1218),k=i(68390),D=i(68732),I=i(8978),P=i(33378),E=i(77849),R=i(43666),A=i(25675),Z=i.n(A),O=i(7954),M=i(87931),T=i(11505);let H=()=>{var e,n,i;let{node:s,nodesOnSameASN:N,baseLatency:A,lastMetricsCheck:H,calculatedRewards:z,isUserLinked:ei,isLinkable:er,creationDate:et,nameCtrl:ea,descriptionCtrl:es,bannerCtrl:el,pictureCtrl:eo,isOwner:ed,isDirty:ec,rewardCtrl:em,streamRewardCtrl:eu,addressCtrl:eh,asnTier:ep,nodeSpecs:ev,nodeIssue:ef,createInstanceUrl:ex,handleRemove:ej,handleSubmit:eg,handleLink:ey,handleUnlink:e_}=function(){let e=(0,c.useRouter)(),{hash:n}=e.query,[i]=(0,o.mr)(),{account:r}=i.account,{entities:t}=i.crns,{node:s}=function(e){let{hash:n}=e,[i]=(0,o.mr)(),{entities:r}=i.crns,t=(0,a.useMemo)(()=>{if(r)return r.filter(e=>e.hash===n)},[r,n]),[s]=t||[];return{node:s}}({hash:n}),{userNode:l}=(0,h.h)({}),N=(0,a.useMemo)(()=>new d.B(r),[r]);N.isUserLinked;let{calculatedRewards:b}=(0,m.H)({address:(null==s?void 0:s.reward)||""}),S=(0,u._)({node:s,nodes:t}),k=(0,a.useMemo)(()=>{if(s)return N.isUserLinked(s,l)},[s,N,l]),D=(0,a.useMemo)(()=>{if(s)return N.isLinkable(s,l)[0]},[s,N,l]),{handleLink:I,handleUnlink:P}=(0,g.i)(),E=(0,a.useCallback)(async()=>{if(!s)return;let n=await I(s.hash);n&&l&&e.replace("/earn/ccn/".concat(l.hash))},[I,e,s,l]),R=(0,a.useCallback)(async()=>{if(!s)return;let n=await P(s.hash);n&&l&&e.replace("/earn/ccn/".concat(null==l?void 0:l.hash))},[P,e,s,l]),{top:A}=(0,y.d)({nodes:t}),Z=A.find(e=>{var n;return e.name===(null==s?void 0:null===(n=s.metricsData)||void 0===n?void 0:n.as_name)}),O=(0,a.useMemo)(()=>{if(s)return[s]},[s]),{specs:M}=(0,_.O)({nodes:O}),{ips:T}=function(e){let{nodes:n}=e,[i]=(0,o.mr)(),{account:r}=i.account,t=(0,a.useMemo)(()=>new d.B(r),[r]),[s,l]=(0,a.useState)({}),[c,m]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async function(){n&&(await Promise.allSettled(n.filter(e=>!t.isStreamPaymentNotSupported(e)).map(async e=>{if(s[e.hash])return;let n=await t.getCRNips(e);l(i=>({...i,[e.hash]:{data:n,loading:!1,error:void 0}}))})),m(!1))})()},[s,t,n]),{ips:s,loading:c}}({nodes:O}),H=(0,a.useMemo)(()=>({cpu:1,ram:(0,w.Fx)(2,{from:"GiB",to:"MiB"}),storage:(0,w.Fx)(20,{from:"GiB",to:"MiB"})}),[]),z=(0,a.useMemo)(()=>{if(O)return O.reduce((e,n)=>{var i,r;let t=N.isStreamPaymentNotSupported(n);if(t)return e[n.hash]=t,e;let a=null===(i=M[n.hash])||void 0===i?void 0:i.data;if(a){let i=N.validateMinNodeSpecs(H,a);if(!i)return e[n.hash]=d.r.MinSpecs,e}let s=null===(r=T[n.hash])||void 0===r?void 0:r.data;if(s){let i=!!s.vm;if(!i)return e[n.hash]=d.r.IPV6,e}return a&&s&&(e[n.hash]=d.r.Valid),e},{})},[O,N,M,T,H]),B=(0,a.useMemo)(()=>{var e;if(s)return null===(e=M[s.hash])||void 0===e?void 0:e.data},[M,s]),L=(0,a.useMemo)(()=>{if(s)return null==z?void 0:z[s.hash]},[z,s]),F=(0,a.useMemo)(()=>{if(s)return void 0===L||L?void 0:"".concat(C.RG,"/").concat(s.hash)},[s,L]),U=(0,a.useMemo)(()=>({hash:null==s?void 0:s.hash,name:null==s?void 0:s.name,description:null==s?void 0:s.description,reward:null==s?void 0:s.reward,stream_reward:null==s?void 0:s.stream_reward,authorized:null==s?void 0:s.authorized,locked:null==s?void 0:s.locked,registration_url:null==s?void 0:s.registration_url,picture:null==s?void 0:s.picture,banner:null==s?void 0:s.banner,address:null==s?void 0:s.address}),[s]),G=function(e){let{defaultValues:n}=e,[i,r]=(0,o.mr)(),{account:t}=i.account,{entities:s}=i.crns,l=(0,x.lm)(),c=(0,a.useMemo)(()=>new d.B(t),[t]),m=(0,a.useCallback)(async e=>{if(!c)throw Error("Manager not ready");if(!t)throw Error("Invalid account");let[,n]=await c.updateComputeResourceNode(e),i=null==s?void 0:s.find(e=>e.hash===n.hash),r=function(e,n){let i={...e||{},...n,virtual:Date.now()};return i}(i,n);return r},[t,c,s]),u=(0,a.useCallback)(async e=>{if(!l)throw Error("Notification not ready");l.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),r(new j.Wy({name:"crns",entities:[e]}))},[r,l]),{control:h,handleSubmit:g,formState:{errors:y,isDirty:_}}=(0,p.c)({defaultValues:n,onSubmit:m,onSuccess:u,resolver:(0,f.F)(d.B.updateCRNSchema),readyDeps:[n]}),C=(0,v.qo)({control:h}),w=(0,v.bc)({control:h,name:"name"}),N=(0,v.bc)({control:h,name:"description"}),b=(0,v.bc)({control:h,name:"address"}),S=(0,v.bc)({control:h,name:"picture"}),k=(0,v.bc)({control:h,name:"banner"}),D=(0,v.bc)({control:h,name:"reward"}),I=(0,v.bc)({control:h,name:"stream_reward"}),P=(0,v.bc)({control:h,name:"authorized"}),E=(0,v.bc)({control:h,name:"locked"}),R=(0,v.bc)({control:h,name:"registration_url"});return{values:C,control:h,nameCtrl:w,descriptionCtrl:N,addressCtrl:b,pictureCtrl:S,bannerCtrl:k,rewardCtrl:D,streamRewardCtrl:I,authorizedCtrl:P,lockedCtrl:E,registrationUrlCtrl:R,errors:y,isDirty:_,handleSubmit:g}}({defaultValues:U});return{nodes:t,node:s,userNode:l,calculatedRewards:b,isUserLinked:k,isLinkable:D,asnTier:Z,nodeSpecs:B,nodeIssue:L,createInstanceUrl:F,handleLink:E,handleUnlink:R,...G,...S}}(),eC=(0,t.Fg)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,r.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,r.jsx)("section",{children:(0,r.jsx)(S.Z,{node:s,nameCtrl:ea,descriptionCtrl:es,bannerCtrl:el,pictureCtrl:eo,isOwner:ed})}),ed&&(0,r.jsxs)(B,{children:[(0,r.jsxs)(x.zx,{kind:"flat",variant:"textOnly",size:"md",color:"error",onClick:ej,children:[(0,r.jsx)(x.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,r.jsx)(x.zx,{kind:"neon",variant:"primary",size:"md",color:"main2",onClick:eg,disabled:!ec,children:"save changes"})]}),(0,r.jsx)(L,{children:(0,r.jsxs)(D.Z,{children:[(0,r.jsx)("div",{children:(0,r.jsxs)(k.ZP,{title:"GENERAL INFO",children:[(0,r.jsx)(I.Z,{status:null==s?void 0:s.status}),(0,r.jsx)(k.HC,{name:"NAME",value:null==s?void 0:s.name}),(0,r.jsx)(k.HC,{name:"ASN",value:null==s?void 0:null===(e=s.metricsData)||void 0===e?void 0:e.as_name}),(0,r.jsx)(k.HC,{name:"OWNER",value:(0,r.jsx)(R.Z,{href:(0,w.tz)({address:null==s?void 0:s.owner}),isOwner:!1,children:(null==s?void 0:s.owner)&&(0,w.zN)(null==s?void 0:s.owner)}),big:!0}),(0,r.jsx)(k.HC,{name:"REWARD ADDRESS",value:(0,r.jsx)(E.Z,{...em.field,...em.fieldState,placeholder:"reward address",isOwner:ed,children:(0,r.jsx)(R.Z,{href:(0,w.tz)({tokenAddress:em.field.value}),isOwner:ed,children:em.field.value&&(0,w.zN)(em.field.value)})}),big:!0}),(0,r.jsx)(k.HC,{name:"STREAM REWARD ADDRESS",value:(0,r.jsx)(E.Z,{...eu.field,...eu.fieldState,placeholder:"PAYG reward address",isOwner:ed,children:(0,r.jsx)(R.Z,{href:(0,w.gl)({tokenAddress:eu.field.value}),isOwner:ed,children:eu.field.value&&(0,w.zN)(eu.field.value)})}),big:!0}),(0,r.jsx)(k.HC,{name:"ADDRESS",value:(0,r.jsx)(E.Z,{...eh.field,...eh.fieldState,placeholder:"address",isOwner:ed,children:(0,r.jsx)(R.Z,{href:null==s?void 0:s.address,isOwner:ed,children:null==s?void 0:s.address})}),big:!0})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)(k.ZP,{title:"HARDWARE",children:[(0,r.jsx)(k.HC,{name:"CPU",value:null==ev?void 0:ev.properties.cpu.vendor}),(0,r.jsx)(k.HC,{name:"CPU ARCHITECTURE",value:null==ev?void 0:ev.properties.cpu.architecture}),(0,r.jsx)(k.HC,{name:"CPU COUNT",value:null==ev?void 0:ev.cpu.count}),(0,r.jsx)(k.HC,{name:"CPU FREQUENCY",value:"".concat((((null==ev?void 0:ev.cpu.core_frequencies.max)||0)/1024).toFixed(2)," GHz")}),(0,r.jsx)(k.HC,{name:"RAM",value:(0,w.eB)(null==ev?void 0:ev.mem.total_kB,"KiB")}),(0,r.jsx)(k.HC,{name:"HDD",value:(0,w.eB)(null==ev?void 0:ev.disk.total_kB,"KiB")}),(0,r.jsxs)(F,{children:[(0,r.jsx)(M.Z,{href:ex||"#",target:"_blank",kind:"neon",variant:"primary",size:"md",disabled:!ex,children:(0,r.jsxs)(r.Fragment,{children:["Create Instance",void 0===ef&&(0,r.jsx)(T.g4,{width:"1em",height:"1em",color:eC.color.background})]})}),!ex&&(0,r.jsx)(U,{className:"fs-10",children:ef?(0,r.jsx)(x.u,{my:"top-center",at:"bottom-center",content:(0,r.jsxs)("div",{className:"tp-body1 fs-12",children:[(0,r.jsx)("div",{className:"tp-body3 fs-16",children:"Why is my node unavailable?"}),(0,r.jsx)("div",{children:"A node may be not eligible for PAYG for the following reasons:"}),(0,r.jsxs)(G,{children:[ef===d.r.IPV6&&(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"IPv6 Egress Issue:"})," The node's compute resource (CRN) is unable to establish an IPv6 egress connection."]}),ef===d.r.MinSpecs&&(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Minimum Specifications:"})," The node does not meet the required minimum hardware or software specifications."]}),ef===d.r.Version&&(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Version Compatibility:"})," Only nodes with version 0.4.0 or higher are eligible for selection."]}),ef===d.r.RewardAddress&&(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Stream Reward Configuration:"})," ","The node lacks a configured stream reward address, which is necessary for operation."]})]})]}),children:(0,r.jsxs)(W,{children:["Not eligible for pay-as-you-go (PAYG)",(0,r.jsx)(Y,{name:"exclamation-circle"})]})}):(0,r.jsx)(J,{children:"Not eligible for pay-as-you-go (PAYG)"})})]})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(k.ZP,{title:"REWARD INDICATORS",children:[(0,r.jsx)(k.HC,{name:"NODES ON ASN",value:(0,r.jsxs)(V,{className:ep&&"text-".concat(ep.color),children:[N,!!ep&&(0,r.jsx)(x.JO,{name:"hexagon-exclamation",color:ep.color})]})}),(0,r.jsx)(k.HC,{name:"VERSION",value:null==s?void 0:null===(n=s.metricsData)||void 0===n?void 0:n.version}),(0,r.jsx)(k.HC,{name:"BASE LATENCY",value:A}),(0,r.jsx)(k.HC,{name:"LAST CHECK",value:H})]}),(0,r.jsx)(k.ZP,{title:"POTENTIAL REWARD",children:(0,r.jsx)(k.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,r.jsx)(O.Z,{value:z})})})]}),(0,r.jsx)("div",{children:(0,r.jsx)(k.ZP,{title:"LINKED CORE NODE",children:(null==s?void 0:s.parentData)?(0,r.jsxs)($,{children:[(0,r.jsx)(b(),{href:"/earn/ccn/".concat(s.parentData.hash),legacyBehavior:!0,children:(0,r.jsx)(ee,{hash:s.parentData.hash,name:s.parentData.name,picture:s.parentData.picture,apiServer:C.pf,ImageCmp:Z()})}),ei?(0,r.jsx)("button",{onClick:e_,children:(0,r.jsx)(x.JO,{name:"trash",color:"error"})}):(0,r.jsx)(r.Fragment,{})]}):(0,r.jsxs)(q,{children:[(0,r.jsx)(K,{}),(0,r.jsx)(X,{className:"fs-10",children:!ei&&er?(0,r.jsx)(x.zx,{color:"main2",size:"md",kind:"neon",variant:"textOnly",onClick:ey,children:(0,r.jsxs)("div",{children:[(0,r.jsx)(Q,{name:"link"})," link now"]})}):(0,r.jsx)(r.Fragment,{children:"not linked"})})]})})}),(0,r.jsx)("div",{children:(0,r.jsxs)(k.ZP,{title:"DECENTRALIZED SCORE",children:[(0,r.jsxs)(en,{className:ep&&"text-".concat(ep.color),children:[(0,r.jsx)(P.Z,{decentralization:(null==s?void 0:null===(i=s.scoreData)||void 0===i?void 0:i.decentralization)||0}),!!ep&&(0,r.jsx)(x.JO,{name:"hexagon-exclamation",color:ep.color})]}),!!ep&&(0,r.jsxs)("p",{className:"tp-body3 fs-10",children:["There are ",N," nodes on this ASN. Please consider to migrate your node to a different ASN."]})]})}),(0,r.jsx)("div",{children:(0,r.jsx)(k.ZP,{title:"PERFORMANCE",children:(0,r.jsx)(k.HC,{name:"CREATION TIME",value:et})})})]})})]})};H.displayName="ComputeResourceNodeDetailPage";var z=(0,a.memo)(H),B=(0,t.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),L=(0,t.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),F=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({paddingTop:"1.5rem",textAlign:"center"}),U=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({marginTop:"1rem"}),G=(0,t.ZP)("ul").withConfig({displayName:"cmp___StyledUl",componentId:"sc-b9jk28-4"})({marginTop:"1rem",marginBottom:"1rem",listStyleType:"disc",paddingLeft:"1.5rem"}),W=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-5"})({display:"flex",cursor:"help",alignItems:"center",justifyContent:"center"}),Y=(0,t.ZP)(x.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-6"})({marginLeft:"0.5rem"}),J=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-7"})({textAlign:"center"}),V=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-8"})({display:"flex",alignItems:"center",gap:"0.75rem"}),q=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-9"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),K=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-b9jk28-10"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),X=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv8",componentId:"sc-b9jk28-11"})({lineHeight:"1rem"}),Q=(0,t.ZP)(x.JO).withConfig({displayName:"cmp___StyledIcon2",componentId:"sc-b9jk28-12"})({height:"0.875rem",width:"0.875rem"}),$=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv9",componentId:"sc-b9jk28-13"})({display:"flex",alignItems:"center"}),ee=(0,t.ZP)(x.tJ).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-14"})({marginRight:"auto",width:"auto",cursor:"pointer"}),en=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv10",componentId:"sc-b9jk28-15"})({display:"flex",alignItems:"center",gap:"0.75rem"}),ei=z}},function(e){e.O(0,[959,312,505,244,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);