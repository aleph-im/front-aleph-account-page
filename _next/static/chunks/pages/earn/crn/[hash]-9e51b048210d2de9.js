(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(97172)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return d}});var a=i(85893),r=i(19521),t=i(67294);let l=r.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,a=i?n.color.main1:"".concat(n.color.base0,"20");return[{height:"0.75rem",width:"0.5rem"},(0,r.iv)(["background-color:",";"],a)]}),s=e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,a.jsx)(o,{children:(0,a.jsx)(c,{children:Array.from({length:3},(e,r)=>(0,a.jsx)(l,{$active:n>=i(r)},r))})})};s.displayName="NodeDecentralization";var d=(0,t.memo)(s),o=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},97172:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return J}});var a=i(85893),r=i(19521),t=i(67294),l=i(9008),s=i.n(l),d=i(94461),o=i(48107),c=i(11163),m=i(94527),u=i(15457),h=i(58193),p=i(10159),v=i(87536),x=i(56312),j=i(7251),f=i(91421),g=i(73384),w=i(34853),_=i(41664),C=i.n(_),y=i(1218),N=i(68390),k=i(68732),b=i(8978),D=i(71806),E=i(33378),S=i(33445),I=i(77849),Z=i(43666);let R=()=>{var e,n,i;let{node:r,nodesOnSameASN:l,baseLatency:_,lastMetricsCheck:D,calculatedRewards:R,isUserLinked:P,isLinkable:J,creationDate:U,nameCtrl:Y,descriptionCtrl:q,bannerCtrl:K,pictureCtrl:X,isOwner:G,isDirty:V,rewardCtrl:$,addressCtrl:Q,handleRemove:ee,handleSubmit:en,handleLink:ei,handleUnlink:ea}=function(){let e=(0,c.useRouter)(),{hash:n}=e.query,[i]=(0,d.mr)(),{account:a}=i.account,{entities:r}=i.crns,{node:l}=function(e){let{hash:n}=e,[i]=(0,d.mr)(),{entities:a}=i.crns,r=(0,t.useMemo)(()=>{if(a)return a.filter(e=>e.hash===n)},[a,n]),[l]=r||[];return{node:l}}({hash:n}),{userNode:s}=(0,h.h)({}),w=(0,t.useMemo)(()=>new o.B(a),[a]);w.isUserLinked;let{calculatedRewards:_}=(0,m.H)({address:(null==l?void 0:l.reward)||""}),C=(0,u._)({node:l,nodes:r}),y=(0,t.useMemo)(()=>{if(l)return w.isUserLinked(l,s)},[l,w,s]),N=(0,t.useMemo)(()=>{if(l)return w.isLinkable(l,s)[0]},[l,w,s]),{handleLink:k,handleUnlink:b}=(0,g.i)(),D=(0,t.useCallback)(async()=>{if(!l)return;let n=await k(l.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[k,e,l,s]),E=(0,t.useCallback)(async()=>{if(!l)return;let n=await b(l.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[b,e,l,s]),S=(0,t.useMemo)(()=>({hash:null==l?void 0:l.hash,name:null==l?void 0:l.name,description:null==l?void 0:l.description,reward:null==l?void 0:l.reward,authorized:null==l?void 0:l.authorized,locked:null==l?void 0:l.locked,registration_url:null==l?void 0:l.registration_url,manager:null==l?void 0:l.manager,picture:null==l?void 0:l.picture,banner:null==l?void 0:l.banner,address:null==l?void 0:l.address}),[l]),I=function(e){let{defaultValues:n}=e,[i,a]=(0,d.mr)(),{account:r}=i.account,{entities:l}=i.crns,s=(0,j.lm)(),c=(0,t.useMemo)(()=>new o.B(r),[r]),m=(0,t.useCallback)(async e=>{if(!c)throw Error("Manager not ready");if(!r)throw Error("Invalid account");let[,n]=await c.updateComputeResourceNode(e),i=null==l?void 0:l.find(e=>e.hash===n.hash),a=function(e,n){let i={...e||{},...n,virtual:Date.now()};return i}(i,n);return a},[r,c,l]),u=(0,t.useCallback)(async e=>{if(!s)throw Error("Notification not ready");s.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),a(new f.Wy({name:"crns",entities:[e]}))},[a,s]),{control:h,handleSubmit:g,formState:{errors:w,isDirty:_}}=(0,p.c)({defaultValues:n,onSubmit:m,onSuccess:u,resolver:(0,x.F)(o.B.updateCCNSchema),readyDeps:[n]}),C=(0,v.qo)({control:h}),y=(0,v.bc)({control:h,name:"name"}),N=(0,v.bc)({control:h,name:"description"}),k=(0,v.bc)({control:h,name:"address"}),b=(0,v.bc)({control:h,name:"picture"}),D=(0,v.bc)({control:h,name:"banner"}),E=(0,v.bc)({control:h,name:"reward"}),S=(0,v.bc)({control:h,name:"manager"}),I=(0,v.bc)({control:h,name:"authorized"}),Z=(0,v.bc)({control:h,name:"locked"}),R=(0,v.bc)({control:h,name:"registration_url"});return{values:C,control:h,nameCtrl:y,descriptionCtrl:N,addressCtrl:k,pictureCtrl:b,bannerCtrl:D,rewardCtrl:E,managerCtrl:S,authorizedCtrl:I,lockedCtrl:Z,registrationUrlCtrl:R,errors:w,isDirty:_,handleSubmit:g}}({defaultValues:S});return{nodes:r,node:l,userNode:s,calculatedRewards:_,isUserLinked:y,isLinkable:N,handleLink:D,handleUnlink:E,...I,...C}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,a.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,a.jsx)("section",{children:(0,a.jsx)(y.Z,{node:r,nameCtrl:Y,descriptionCtrl:q,bannerCtrl:K,pictureCtrl:X,isOwner:G})}),G&&(0,a.jsxs)(A,{children:[(0,a.jsxs)(j.zx,{kind:"flat",variant:"text-only",size:"regular",color:"error",onClick:ee,children:[(0,a.jsx)(j.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,a.jsx)(j.zx,{kind:"neon",variant:"primary",size:"regular",color:"main2",onClick:en,disabled:!V,children:"save changes"})]}),(0,a.jsx)(O,{children:(0,a.jsxs)(k.Z,{children:[(0,a.jsx)("div",{children:(0,a.jsxs)(N.ZP,{title:"GENERAL INFO",children:[(0,a.jsx)(b.Z,{status:null==r?void 0:r.status}),(0,a.jsx)(N.HC,{name:"NAME",value:null==r?void 0:r.name}),(0,a.jsx)(N.HC,{name:"OWNER",value:(0,a.jsx)(Z.Z,{href:(0,w.tz)({address:null==r?void 0:r.owner}),isOwner:!1,children:(null==r?void 0:r.owner)&&(0,w.zN)(null==r?void 0:r.owner)}),big:!0}),(0,a.jsx)(N.HC,{name:"REWARD ADDRESS",value:(0,a.jsx)(I.Z,{...$.field,...$.fieldState,placeholder:"address",isOwner:G,children:(0,a.jsx)(Z.Z,{href:(0,w.tz)({tokenAddress:$.field.value}),isOwner:G,children:$.field.value&&(0,w.zN)($.field.value)})}),big:!0}),(0,a.jsx)(N.HC,{name:"ADDRESS",value:(0,a.jsx)(I.Z,{...Q.field,...Q.fieldState,placeholder:"address",isOwner:G,children:(0,a.jsx)(Z.Z,{href:null==r?void 0:r.address,isOwner:G,children:null==r?void 0:r.address})}),big:!0})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.ZP,{title:"REWARD INDICATORS",children:[(0,a.jsx)(N.HC,{name:"ASN",value:null==r?void 0:null===(e=r.metricsData)||void 0===e?void 0:e.as_name}),(0,a.jsx)(N.HC,{name:"NODES ON ASN",value:l}),(0,a.jsx)(N.HC,{name:"VERSION",value:null==r?void 0:null===(n=r.metricsData)||void 0===n?void 0:n.version}),(0,a.jsx)(N.HC,{name:"BASE LATENCY",value:_}),(0,a.jsx)(N.HC,{name:"LAST CHECK",value:D})]}),(0,a.jsx)(N.ZP,{title:"POTENTIAL REWARD",children:(0,a.jsx)(N.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,a.jsxs)(z,{children:[(0,a.jsx)(T,{children:null==R?void 0:R.toFixed(5)}),(0,a.jsx)(j.TR,{text:"",color:"main0"})]})})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(N.ZP,{title:"LINKED CORE NODE",children:(null==r?void 0:r.parentData)?(0,a.jsxs)(B,{children:[(0,a.jsx)(C(),{href:"/earn/ccn/".concat(r.parentData.hash),legacyBehavior:!0,children:(0,a.jsx)(W,{hash:r.parentData.hash,name:r.parentData.name,picture:r.parentData.picture})}),P?(0,a.jsx)("button",{onClick:ea,children:(0,a.jsx)(j.JO,{name:"trash",color:"error"})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)(H,{children:[(0,a.jsx)(M,{}),(0,a.jsx)(L,{className:"fs-10",children:!P&&J?(0,a.jsx)(j.zx,{color:"main2",size:"regular",kind:"neon",variant:"text-only",onClick:ei,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(F,{name:"link"})," link now"]})}):(0,a.jsx)(a.Fragment,{children:"not linked"})})]})})}),(0,a.jsx)("div",{children:(0,a.jsx)(N.ZP,{title:"DECENTRALIZED SCORE",children:(0,a.jsx)(E.Z,{decentralization:(null==r?void 0:null===(i=r.scoreData)||void 0===i?void 0:i.decentralization)||0})})}),(0,a.jsx)("div",{children:(0,a.jsx)(N.ZP,{title:"PERFORMANCE",children:(0,a.jsx)(N.HC,{name:"CREATION TIME",value:U})})})]})}),(0,a.jsx)(S.Z,{show:!r,center:!0})]})};R.displayName="ComputeResourceNodeDetailPage";var P=(0,t.memo)(R),A=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),O=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),z=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({display:"inline-flex",alignItems:"center",gap:"0.5rem"}),T=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({whiteSpace:"nowrap"}),H=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),M=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),L=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-6"})({lineHeight:"1rem"}),F=(0,r.ZP)(j.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-7"})({height:"0.875rem",width:"0.875rem"}),B=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-8"})({display:"flex",alignItems:"center"}),W=(0,r.ZP)(D.Z).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-9"})({marginRight:"auto",width:"auto",cursor:"pointer"}),J=P}},function(e){e.O(0,[959,312,987,154,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);