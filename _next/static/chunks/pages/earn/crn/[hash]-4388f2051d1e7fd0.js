(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(97172)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return d}});var a=i(85893),r=i(19521),t=i(67294);let l=r.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,a=i?n.color.main1:"".concat(n.color.base0,"20");return[{height:"0.75rem",width:"0.5rem"},(0,r.iv)(["background-color:",";"],a)]}),s=(0,t.memo)(e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,a.jsx)(o,{children:(0,a.jsx)(c,{children:Array.from({length:3},(e,r)=>(0,a.jsx)(l,{$active:n>=i(r)},r))})})});s.displayName="NodeDecentralization";var d=s,o=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},97172:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return U}});var a=i(85893),r=i(19521),t=i(67294),l=i(9008),s=i.n(l),d=i(1218),o=i(94461),c=i(48107),m=i(11163),u=i(94527),h=i(15457),p=i(58193),v=i(10159),x=i(87536),j=i(56312),f=i(7251),g=i(91421),w=i(73384),_=i(91077),C=i(39229),y=i(68732),N=i(34853),k=i(8978),b=i(41664),D=i.n(b),E=i(71806),S=i(33378),I=i(46445),Z=i(77849),R=i(43666);let A=()=>{var e,n,i;let{node:r,nodesOnSameASN:l,baseLatency:b,lastMetricsCheck:E,calculatedRewards:A,isUserLinked:O,isLinkable:U,creationDate:Y,nameCtrl:q,descriptionCtrl:K,bannerCtrl:X,pictureCtrl:G,isOwner:V,isDirty:$,rewardCtrl:Q,addressCtrl:ee,handleRemove:en,handleSubmit:ei,handleLink:ea,handleUnlink:er}=function(){let e=(0,m.useRouter)(),{hash:n}=e.query,[i]=(0,o.mr)(),{account:a}=i.account,{entities:r}=i.crns,{node:l}=function(e){let{hash:n}=e,[i]=(0,o.mr)(),{entities:a}=i.crns,r=(0,t.useMemo)(()=>{if(a)return a.filter(e=>e.hash===n)},[a,n]),[l]=r||[];return{node:l}}({hash:n}),{userNode:s}=(0,p.h)({}),d=(0,t.useMemo)(()=>new c.B(a),[a]);d.isUserLinked;let{calculatedRewards:_}=(0,u.H)({address:(null==l?void 0:l.reward)||""}),C=(0,h._)({node:l,nodes:r}),y=(0,t.useMemo)(()=>{if(l)return d.isUserLinked(l,s)},[l,d,s]),N=(0,t.useMemo)(()=>{if(l)return d.isLinkable(l,s)[0]},[l,d,s]),{handleLink:k,handleUnlink:b}=(0,w.i)(),D=(0,t.useCallback)(async()=>{if(!l)return;let n=await k(l.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[k,e,l,s]),E=(0,t.useCallback)(async()=>{if(!l)return;let n=await b(l.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[b,e,l,s]),S=(0,t.useMemo)(()=>({hash:null==l?void 0:l.hash,name:null==l?void 0:l.name,description:null==l?void 0:l.description,reward:null==l?void 0:l.reward,authorized:null==l?void 0:l.authorized,locked:null==l?void 0:l.locked,registration_url:null==l?void 0:l.registration_url,manager:null==l?void 0:l.manager,picture:null==l?void 0:l.picture,banner:null==l?void 0:l.banner,address:null==l?void 0:l.address}),[l]),I=function(e){let{defaultValues:n}=e,[i,a]=(0,o.mr)(),{account:r}=i.account,{entities:l}=i.crns,s=(0,f.lm)(),d=(0,t.useMemo)(()=>new c.B(r),[r]),m=(0,t.useCallback)(async e=>{if(!d)throw Error("Manager not ready");if(!r)throw Error("Invalid account");let[,n]=await d.updateComputeResourceNode(e),i=null==l?void 0:l.find(e=>e.hash===n.hash),a=function(e,n){let i={...e||{},...n,virtual:Date.now()};return i}(i,n);return a},[r,d,l]),u=(0,t.useCallback)(async e=>{if(!s)throw Error("Notification not ready");s.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),a(new g.Wy({name:"crns",entities:[e]}))},[a,s]),{control:h,handleSubmit:p,formState:{errors:w,isDirty:_}}=(0,v.c)({defaultValues:n,onSubmit:m,onSuccess:u,resolver:(0,j.F)(c.B.updateCCNSchema),readyDeps:[n]}),C=(0,x.qo)({control:h}),y=(0,x.bc)({control:h,name:"name"}),N=(0,x.bc)({control:h,name:"description"}),k=(0,x.bc)({control:h,name:"address"}),b=(0,x.bc)({control:h,name:"picture"}),D=(0,x.bc)({control:h,name:"banner"}),E=(0,x.bc)({control:h,name:"reward"}),S=(0,x.bc)({control:h,name:"manager"}),I=(0,x.bc)({control:h,name:"authorized"}),Z=(0,x.bc)({control:h,name:"locked"}),R=(0,x.bc)({control:h,name:"registration_url"});return{values:C,control:h,nameCtrl:y,descriptionCtrl:N,addressCtrl:k,pictureCtrl:b,bannerCtrl:D,rewardCtrl:E,managerCtrl:S,authorizedCtrl:I,lockedCtrl:Z,registrationUrlCtrl:R,errors:w,isDirty:_,handleSubmit:p}}({defaultValues:S});return{nodes:r,node:l,userNode:s,calculatedRewards:_,isUserLinked:y,isLinkable:N,handleLink:D,handleUnlink:E,...I,...C}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,a.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,a.jsx)("section",{children:(0,a.jsx)(d.Z,{node:r,nameCtrl:q,descriptionCtrl:K,bannerCtrl:X,pictureCtrl:G,isOwner:V})}),V&&(0,a.jsxs)(P,{children:[(0,a.jsxs)(f.zx,{kind:"flat",variant:"text-only",size:"regular",color:"error",onClick:en,children:[(0,a.jsx)(f.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,a.jsx)(f.zx,{kind:"neon",variant:"primary",size:"regular",color:"main2",onClick:ei,disabled:!$,children:"save changes"})]}),(0,a.jsx)(z,{children:(0,a.jsxs)(y.Z,{children:[(0,a.jsx)("div",{children:(0,a.jsxs)(_.Z,{title:"GENERAL INFO",children:[(0,a.jsx)(k.Z,{status:null==r?void 0:r.status}),(0,a.jsx)(C.HC,{name:"NAME",value:null==r?void 0:r.name}),(0,a.jsx)(C.HC,{name:"OWNER",value:(0,a.jsx)(R.Z,{href:(0,N.tz)({address:null==r?void 0:r.owner}),isOwner:!1,children:(null==r?void 0:r.owner)&&(0,N.zN)(null==r?void 0:r.owner)}),big:!0}),(0,a.jsx)(C.HC,{name:"REWARD ADDRESS",value:(0,a.jsx)(Z.Z,{...Q.field,...Q.fieldState,placeholder:"address",isOwner:V,children:(0,a.jsx)(R.Z,{href:(0,N.tz)({tokenAddress:Q.field.value}),isOwner:V,children:Q.field.value&&(0,N.zN)(Q.field.value)})}),big:!0}),(0,a.jsx)(C.HC,{name:"ADDRESS",value:(0,a.jsx)(Z.Z,{...ee.field,...ee.fieldState,placeholder:"address",isOwner:V,children:(0,a.jsx)(R.Z,{href:null==r?void 0:r.address,isOwner:V,children:null==r?void 0:r.address})}),big:!0})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(_.Z,{title:"REWARD INDICATORS",children:[(0,a.jsx)(C.HC,{name:"ASN",value:null==r?void 0:null===(e=r.metricsData)||void 0===e?void 0:e.as_name}),(0,a.jsx)(C.HC,{name:"NODES ON ASN",value:l}),(0,a.jsx)(C.HC,{name:"VERSION",value:null==r?void 0:null===(n=r.metricsData)||void 0===n?void 0:n.version}),(0,a.jsx)(C.HC,{name:"BASE LATENCY",value:b}),(0,a.jsx)(C.HC,{name:"LAST CHECK",value:E})]}),(0,a.jsx)(_.Z,{title:"POTENTIAL REWARD",children:(0,a.jsx)(C.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,a.jsxs)(T,{children:[(0,a.jsx)(H,{children:null==A?void 0:A.toFixed(5)}),(0,a.jsx)(f.TR,{text:"",color:"main0"})]})})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"LINKED CORE NODE",children:(null==r?void 0:r.parentData)?(0,a.jsxs)(W,{children:[(0,a.jsx)(D(),{href:"/earn/ccn/".concat(r.parentData.hash),legacyBehavior:!0,children:(0,a.jsx)(J,{hash:r.parentData.hash,name:r.parentData.name,picture:r.parentData.picture})}),O?(0,a.jsx)("button",{onClick:er,children:(0,a.jsx)(f.JO,{name:"trash",color:"error"})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)(M,{children:[(0,a.jsx)(L,{}),(0,a.jsx)(F,{className:"fs-10",children:!O&&U?(0,a.jsx)(f.zx,{color:"main2",size:"regular",kind:"neon",variant:"text-only",onClick:ea,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(B,{name:"link"})," link now"]})}):(0,a.jsx)(a.Fragment,{children:"not linked"})})]})})}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"DECENTRALIZED SCORE",children:(0,a.jsx)(S.Z,{decentralization:(null==r?void 0:null===(i=r.scoreData)||void 0===i?void 0:i.decentralization)||0})})}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"PERFORMANCE",children:(0,a.jsx)(C.HC,{name:"CREATION TIME",value:Y})})})]})}),(0,a.jsx)(I.Z,{show:!r,center:!0})]})};A.displayName="ComputeResourceNodeDetailPage";var O=(0,t.memo)(A),P=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),z=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),T=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({display:"inline-flex",alignItems:"center",gap:"0.5rem"}),H=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({whiteSpace:"nowrap"}),M=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),L=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),F=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-6"})({lineHeight:"1rem"}),B=(0,r.ZP)(f.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-7"})({height:"0.875rem",width:"0.875rem"}),W=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-8"})({display:"flex",alignItems:"center"}),J=(0,r.ZP)(E.Z).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-9"})({marginRight:"auto",width:"auto",cursor:"pointer"}),U=O}},function(e){e.O(0,[959,312,2,162,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);