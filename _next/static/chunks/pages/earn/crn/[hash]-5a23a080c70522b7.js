(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(97172)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return d}});var a=i(85893),r=i(19521),l=i(67294);let t=r.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,a=i?n.color.main1:"".concat(n.color.base0,"20");return[{height:"0.75rem",width:"0.5rem"},(0,r.iv)(["background-color:",";"],a)]}),s=(0,l.memo)(e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,a.jsx)(o,{children:(0,a.jsx)(c,{children:Array.from({length:3},(e,r)=>(0,a.jsx)(t,{$active:n>=i(r)},r))})})});s.displayName="NodeDecentralization";var d=s,o=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),c=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},97172:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return J}});var a=i(85893),r=i(19521),l=i(67294),t=i(9008),s=i.n(t),d=i(1218),o=i(94461),c=i(48107),m=i(11163),u=i(94527),h=i(15457),p=i(58193),v=i(10159),x=i(87536),j=i(56312),f=i(7251),g=i(73384),_=i(91077),C=i(39229),w=i(68732),y=i(34853),N=i(8978),k=i(41664),b=i.n(k),D=i(71806),E=i(33378),S=i(46445),Z=i(77849),I=i(43666);let R=()=>{var e,n,i;let{node:r,nodesOnSameASN:t,baseLatency:k,lastMetricsCheck:D,calculatedRewards:R,isUserLinked:A,isLinkable:J,creationDate:U,nameCtrl:Y,descriptionCtrl:q,bannerCtrl:K,pictureCtrl:V,isOwner:X,isDirty:G,rewardCtrl:$,addressCtrl:Q,handleRemove:ee,handleSubmit:en,handleLink:ei,handleUnlink:ea}=function(){let e=(0,m.useRouter)(),{hash:n}=e.query,[i]=(0,o.mr)(),{account:a}=i.account,{entities:r}=i.crns,{node:t}=function(e){let{hash:n}=e,[i]=(0,o.mr)(),{entities:a}=i.crns,r=(0,l.useMemo)(()=>{if(a)return a.filter(e=>e.hash===n)},[a,n]),[t]=r||[];return{node:t}}({hash:n}),{userNode:s}=(0,p.h)({}),d=(0,l.useMemo)(()=>new c.B(a),[a]);d.isUserLinked;let{calculatedRewards:_}=(0,u.H)({address:(null==t?void 0:t.reward)||""}),C=(0,h._)({node:t,nodes:r}),w=(0,l.useMemo)(()=>{if(t)return d.isUserLinked(t,s)},[t,d,s]),y=(0,l.useMemo)(()=>{if(t)return d.isLinkable(t,s)[0]},[t,d,s]),{handleLink:N,handleUnlink:k}=(0,g.i)(),b=(0,l.useCallback)(async()=>{if(!t)return;let n=await N(t.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[N,e,t,s]),D=(0,l.useCallback)(async()=>{if(!t)return;let n=await k(t.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[k,e,t,s]),E=function(e){let{defaultValues:n}=e,i=(0,m.useRouter)(),[a]=(0,o.mr)(),{account:r}=a.account,t=(0,f.lm)(),s=(0,l.useMemo)(()=>new c.B(r),[r]),d=(0,l.useCallback)(async e=>{if(!s)throw Error("Manager not ready");return await s.updateComputeResourceNode(e),e.hash},[s]),u=(0,l.useCallback)(async e=>{if(!t)throw Error("Notification not ready");t.add({variant:"success",title:"Success",text:'Your node "'.concat(e,'" was updated successfully.')}),i.replace("/earn/crn/".concat(e))},[t,i]),{control:h,handleSubmit:p,formState:{errors:g,isDirty:_}}=(0,v.c)({defaultValues:n,onSubmit:d,onSuccess:u,resolver:(0,j.F)(c.B.updateCCNSchema),readyDeps:[null==n?void 0:n.hash]}),C=(0,x.qo)({control:h}),w=(0,x.bc)({control:h,name:"name"}),y=(0,x.bc)({control:h,name:"description"}),N=(0,x.bc)({control:h,name:"address"}),k=(0,x.bc)({control:h,name:"picture"}),b=(0,x.bc)({control:h,name:"banner"}),D=(0,x.bc)({control:h,name:"reward"}),E=(0,x.bc)({control:h,name:"manager"}),S=(0,x.bc)({control:h,name:"authorized"}),Z=(0,x.bc)({control:h,name:"locked"}),I=(0,x.bc)({control:h,name:"registration_url"});return{values:C,control:h,nameCtrl:w,descriptionCtrl:y,addressCtrl:N,pictureCtrl:k,bannerCtrl:b,rewardCtrl:D,managerCtrl:E,authorizedCtrl:S,lockedCtrl:Z,registrationUrlCtrl:I,errors:g,isDirty:_,handleSubmit:p}}({defaultValues:{hash:null==t?void 0:t.hash,name:null==t?void 0:t.name,description:null==t?void 0:t.description,reward:null==t?void 0:t.reward,authorized:null==t?void 0:t.authorized,locked:null==t?void 0:t.locked,registration_url:null==t?void 0:t.registration_url,manager:null==t?void 0:t.manager,picture:null==t?void 0:t.picture,banner:null==t?void 0:t.banner,address:null==t?void 0:t.address}});return{nodes:r,node:t,userNode:s,calculatedRewards:_,isUserLinked:w,isLinkable:y,handleLink:b,handleUnlink:D,...E,...C}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,a.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,a.jsx)("section",{children:(0,a.jsx)(d.Z,{node:r,nameCtrl:Y,descriptionCtrl:q,bannerCtrl:K,pictureCtrl:V,isOwner:X})}),X&&(0,a.jsxs)(O,{children:[(0,a.jsxs)(f.zx,{kind:"flat",variant:"text-only",size:"regular",color:"error",onClick:ee,children:[(0,a.jsx)(f.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,a.jsx)(f.zx,{kind:"neon",variant:"primary",size:"regular",color:"main2",onClick:en,disabled:!G,children:"save changes"})]}),(0,a.jsx)(P,{children:(0,a.jsxs)(w.Z,{children:[(0,a.jsx)("div",{children:(0,a.jsxs)(_.Z,{title:"GENERAL INFO",children:[(0,a.jsx)(N.Z,{status:null==r?void 0:r.status}),(0,a.jsx)(C.HC,{name:"NAME",value:null==r?void 0:r.name}),(0,a.jsx)(C.HC,{name:"OWNER",value:(0,a.jsx)(I.Z,{href:(0,y.tz)({address:null==r?void 0:r.owner}),isOwner:!1,children:(null==r?void 0:r.owner)&&(0,y.zN)(null==r?void 0:r.owner)}),big:!0}),(0,a.jsx)(C.HC,{name:"REWARD ADDRESS",value:(0,a.jsx)(Z.Z,{...$.field,...$.fieldState,placeholder:"address",isOwner:X,children:(0,a.jsx)(I.Z,{href:(0,y.tz)({tokenAddress:$.field.value}),isOwner:X,children:$.field.value&&(0,y.zN)($.field.value)})}),big:!0}),(0,a.jsx)(C.HC,{name:"ADDRESS",value:(0,a.jsx)(Z.Z,{...Q.field,...Q.fieldState,placeholder:"address",isOwner:X,children:(0,a.jsx)(I.Z,{href:null==r?void 0:r.address,isOwner:X,children:null==r?void 0:r.address})}),big:!0})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(_.Z,{title:"REWARD INDICATORS",children:[(0,a.jsx)(C.HC,{name:"ASN",value:null==r?void 0:null===(e=r.metricsData)||void 0===e?void 0:e.as_name}),(0,a.jsx)(C.HC,{name:"NODES ON ASN",value:t}),(0,a.jsx)(C.HC,{name:"VERSION",value:null==r?void 0:null===(n=r.metricsData)||void 0===n?void 0:n.version}),(0,a.jsx)(C.HC,{name:"BASE LATENCY",value:k}),(0,a.jsx)(C.HC,{name:"LAST CHECK",value:D})]}),(0,a.jsx)(_.Z,{title:"POTENTIAL REWARD",children:(0,a.jsx)(C.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,a.jsxs)(z,{children:[(0,a.jsx)(T,{children:null==R?void 0:R.toFixed(5)}),(0,a.jsx)(f.TR,{text:"",color:"main0"})]})})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"LINKED CORE NODE",children:(null==r?void 0:r.parentData)?(0,a.jsxs)(B,{children:[(0,a.jsx)(b(),{href:"/earn/ccn/".concat(r.parentData.hash),legacyBehavior:!0,children:(0,a.jsx)(W,{hash:r.parentData.hash,name:r.parentData.name,picture:r.parentData.picture})}),A?(0,a.jsx)("button",{onClick:ea,children:(0,a.jsx)(f.JO,{name:"trash",color:"error"})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)(H,{children:[(0,a.jsx)(L,{}),(0,a.jsx)(M,{className:"fs-10",children:!A&&J?(0,a.jsx)(f.zx,{color:"main2",size:"regular",kind:"neon",variant:"text-only",onClick:ei,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(F,{name:"link"})," link now"]})}):(0,a.jsx)(a.Fragment,{children:"not linked"})})]})})}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"DECENTRALIZED SCORE",children:(0,a.jsx)(E.Z,{decentralization:(null==r?void 0:null===(i=r.scoreData)||void 0===i?void 0:i.decentralization)||0})})}),(0,a.jsx)("div",{children:(0,a.jsx)(_.Z,{title:"PERFORMANCE",children:(0,a.jsx)(C.HC,{name:"CREATION TIME",value:U})})})]})}),(0,a.jsx)(S.Z,{show:!r,center:!0})]})};R.displayName="ComputeResourceNodeDetailPage";var A=(0,l.memo)(R),O=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),P=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),z=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({display:"inline-flex",alignItems:"center",gap:"0.5rem"}),T=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({whiteSpace:"nowrap"}),H=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),L=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),M=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-6"})({lineHeight:"1rem"}),F=(0,r.ZP)(f.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-7"})({height:"0.875rem",width:"0.875rem"}),B=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-8"})({display:"flex",alignItems:"center"}),W=(0,r.ZP)(D.Z).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-9"})({marginRight:"auto",width:"auto",cursor:"pointer"}),J=A}},function(e){e.O(0,[959,312,2,162,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);