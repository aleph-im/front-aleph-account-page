(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{70805:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/earn/crn/[hash]",function(){return i(97172)}])},33378:function(e,n,i){"use strict";i.d(n,{Z:function(){return o}});var r=i(85893),a=i(19521),t=i(67294);let l=a.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-1w2vi58-0"})(e=>{let{theme:n,$active:i}=e,r=i?n.color.main1:"".concat(n.color.base0,"20");return[{height:"0.75rem",width:"0.5rem"},(0,a.iv)(["background-color:",";"],r)]}),s=e=>{let{decentralization:n}=e,i=e=>(e+1)*.3;return(0,r.jsx)(c,{children:(0,r.jsx)(d,{children:Array.from({length:3},(e,a)=>(0,r.jsx)(l,{$active:n>=i(a)},a))})})};s.displayName="NodeDecentralization";var o=(0,t.memo)(s),c=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-sktw9k-0"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),d=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-sktw9k-1"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},67200:function(e,n,i){"use strict";i.d(n,{d:function(){return a}});var r=i(67294);function a(e){let{nodes:n}=e,i=(0,r.useMemo)(()=>{let e=n||Array.from({length:4},(e,n)=>({metricsData:{as_name:"Provider ".concat(n)}}));return e.reduce((e,n)=>{var i;let r=(null===(i=n.metricsData)||void 0===i?void 0:i.as_name)||"others";return e[r]=(e[r]||0)+1,e},{others:0})},[n]),a=(0,r.useMemo)(()=>Object.values(i).reduce((e,n)=>e+n,0),[i]),t=(0,r.useMemo)(()=>{let e=Object.entries(i).filter(e=>{let[n]=e;return"others"!==n}).sort((e,n)=>{let[,i]=e,[,r]=n;return r-i}),n=e.slice(0,3),r=e.slice(3),t=["others",i.others+r.reduce((e,n)=>{let[,i]=n;return e+i},0)];return[...n,t].map((e,n)=>{let[i,r]=e;return{tier:n+1,name:i,count:r,percentage:r/a,color:0===n?"error":1===n?"main2":2===n?"main0":"main1"}})},[i,a]);return{total:a,buckets:i,top:t}}},97172:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return q}});var r=i(85893),a=i(19521),t=i(67294),l=i(9008),s=i.n(l),o=i(94461),c=i(48107),d=i(11163),m=i(94527),u=i(15457),h=i(58193),p=i(10159),v=i(87536),x=i(56312),j=i(7251),f=i(91421),g=i(73384),_=i(67200),y=i(34853),w=i(41664),N=i.n(w),C=i(1218),k=i(68390),b=i(68732),D=i(8978),S=i(71806),E=i(33378),I=i(33445),Z=i(77849),P=i(43666);let R=()=>{var e,n,i;let{node:a,nodesOnSameASN:l,baseLatency:w,lastMetricsCheck:S,calculatedRewards:R,isUserLinked:O,isLinkable:q,creationDate:K,nameCtrl:X,descriptionCtrl:G,bannerCtrl:V,pictureCtrl:$,isOwner:Q,isDirty:ee,rewardCtrl:en,addressCtrl:ei,asnTier:er,handleRemove:ea,handleSubmit:et,handleLink:el,handleUnlink:es}=function(){let e=(0,d.useRouter)(),{hash:n}=e.query,[i]=(0,o.mr)(),{account:r}=i.account,{entities:a}=i.crns,{node:l}=function(e){let{hash:n}=e,[i]=(0,o.mr)(),{entities:r}=i.crns,a=(0,t.useMemo)(()=>{if(r)return r.filter(e=>e.hash===n)},[r,n]),[l]=a||[];return{node:l}}({hash:n}),{userNode:s}=(0,h.h)({}),y=(0,t.useMemo)(()=>new c.B(r),[r]);y.isUserLinked;let{calculatedRewards:w}=(0,m.H)({address:(null==l?void 0:l.reward)||""}),N=(0,u._)({node:l,nodes:a}),C=(0,t.useMemo)(()=>{if(l)return y.isUserLinked(l,s)},[l,y,s]),k=(0,t.useMemo)(()=>{if(l)return y.isLinkable(l,s)[0]},[l,y,s]),{handleLink:b,handleUnlink:D}=(0,g.i)(),S=(0,t.useCallback)(async()=>{if(!l)return;let n=await b(l.hash);n&&s&&e.replace("/earn/ccn/".concat(s.hash))},[b,e,l,s]),E=(0,t.useCallback)(async()=>{if(!l)return;let n=await D(l.hash);n&&s&&e.replace("/earn/ccn/".concat(null==s?void 0:s.hash))},[D,e,l,s]),{top:I}=(0,_.d)({nodes:a}),Z=I.find(e=>{var n;return e.name===(null==l?void 0:null===(n=l.metricsData)||void 0===n?void 0:n.as_name)}),P=(0,t.useMemo)(()=>({hash:null==l?void 0:l.hash,name:null==l?void 0:l.name,description:null==l?void 0:l.description,reward:null==l?void 0:l.reward,authorized:null==l?void 0:l.authorized,locked:null==l?void 0:l.locked,registration_url:null==l?void 0:l.registration_url,manager:null==l?void 0:l.manager,picture:null==l?void 0:l.picture,banner:null==l?void 0:l.banner,address:null==l?void 0:l.address}),[l]),R=function(e){let{defaultValues:n}=e,[i,r]=(0,o.mr)(),{account:a}=i.account,{entities:l}=i.crns,s=(0,j.lm)(),d=(0,t.useMemo)(()=>new c.B(a),[a]),m=(0,t.useCallback)(async e=>{if(!d)throw Error("Manager not ready");if(!a)throw Error("Invalid account");let[,n]=await d.updateComputeResourceNode(e),i=null==l?void 0:l.find(e=>e.hash===n.hash),r=function(e,n){let i={...e||{},...n,virtual:Date.now()};return i}(i,n);return r},[a,d,l]),u=(0,t.useCallback)(async e=>{if(!s)throw Error("Notification not ready");s.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),r(new f.Wy({name:"crns",entities:[e]}))},[r,s]),{control:h,handleSubmit:g,formState:{errors:_,isDirty:y}}=(0,p.c)({defaultValues:n,onSubmit:m,onSuccess:u,resolver:(0,x.F)(c.B.updateCCNSchema),readyDeps:[n]}),w=(0,v.qo)({control:h}),N=(0,v.bc)({control:h,name:"name"}),C=(0,v.bc)({control:h,name:"description"}),k=(0,v.bc)({control:h,name:"address"}),b=(0,v.bc)({control:h,name:"picture"}),D=(0,v.bc)({control:h,name:"banner"}),S=(0,v.bc)({control:h,name:"reward"}),E=(0,v.bc)({control:h,name:"manager"}),I=(0,v.bc)({control:h,name:"authorized"}),Z=(0,v.bc)({control:h,name:"locked"}),P=(0,v.bc)({control:h,name:"registration_url"});return{values:w,control:h,nameCtrl:N,descriptionCtrl:C,addressCtrl:k,pictureCtrl:b,bannerCtrl:D,rewardCtrl:S,managerCtrl:E,authorizedCtrl:I,lockedCtrl:Z,registrationUrlCtrl:P,errors:_,isDirty:y,handleSubmit:g}}({defaultValues:P});return{nodes:a,node:l,userNode:s,calculatedRewards:w,isUserLinked:C,isLinkable:k,asnTier:Z,handleLink:S,handleUnlink:E,...R,...N}}();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s(),{children:[(0,r.jsx)("title",{children:"Aleph.im | CRN Detail"}),(0,r.jsx)("meta",{name:"description",content:"Aleph.im Compute Resource Node"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,r.jsx)("section",{children:(0,r.jsx)(C.Z,{node:a,nameCtrl:X,descriptionCtrl:G,bannerCtrl:V,pictureCtrl:$,isOwner:Q})}),Q&&(0,r.jsxs)(A,{children:[(0,r.jsxs)(j.zx,{kind:"flat",variant:"text-only",size:"regular",color:"error",onClick:ea,children:[(0,r.jsx)(j.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,r.jsx)(j.zx,{kind:"neon",variant:"primary",size:"regular",color:"main2",onClick:et,disabled:!ee,children:"save changes"})]}),(0,r.jsx)(z,{children:(0,r.jsxs)(b.Z,{children:[(0,r.jsx)("div",{children:(0,r.jsxs)(k.ZP,{title:"GENERAL INFO",children:[(0,r.jsx)(D.Z,{status:null==a?void 0:a.status}),(0,r.jsx)(k.HC,{name:"NAME",value:null==a?void 0:a.name}),(0,r.jsx)(k.HC,{name:"ASN",value:null==a?void 0:null===(e=a.metricsData)||void 0===e?void 0:e.as_name}),(0,r.jsx)(k.HC,{name:"OWNER",value:(0,r.jsx)(P.Z,{href:(0,y.tz)({address:null==a?void 0:a.owner}),isOwner:!1,children:(null==a?void 0:a.owner)&&(0,y.zN)(null==a?void 0:a.owner)}),big:!0}),(0,r.jsx)(k.HC,{name:"REWARD ADDRESS",value:(0,r.jsx)(Z.Z,{...en.field,...en.fieldState,placeholder:"address",isOwner:Q,children:(0,r.jsx)(P.Z,{href:(0,y.tz)({tokenAddress:en.field.value}),isOwner:Q,children:en.field.value&&(0,y.zN)(en.field.value)})}),big:!0}),(0,r.jsx)(k.HC,{name:"ADDRESS",value:(0,r.jsx)(Z.Z,{...ei.field,...ei.fieldState,placeholder:"address",isOwner:Q,children:(0,r.jsx)(P.Z,{href:null==a?void 0:a.address,isOwner:Q,children:null==a?void 0:a.address})}),big:!0})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(k.ZP,{title:"REWARD INDICATORS",children:[(0,r.jsx)(k.HC,{name:"NODES ON ASN",value:(0,r.jsxs)(T,{className:er&&"text-".concat(er.color),children:[l,!!er&&(0,r.jsx)(j.JO,{name:"hexagon-exclamation",color:er.color})]})}),(0,r.jsx)(k.HC,{name:"VERSION",value:null==a?void 0:null===(n=a.metricsData)||void 0===n?void 0:n.version}),(0,r.jsx)(k.HC,{name:"BASE LATENCY",value:w}),(0,r.jsx)(k.HC,{name:"LAST CHECK",value:S})]}),(0,r.jsx)(k.ZP,{title:"POTENTIAL REWARD",children:(0,r.jsx)(k.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,r.jsxs)(H,{children:[(0,r.jsx)(M,{children:null==R?void 0:R.toFixed(5)}),(0,r.jsx)(j.TR,{text:"",color:"main0"})]})})})]}),(0,r.jsx)("div",{children:(0,r.jsx)(k.ZP,{title:"LINKED CORE NODE",children:(null==a?void 0:a.parentData)?(0,r.jsxs)(J,{children:[(0,r.jsx)(N(),{href:"/earn/ccn/".concat(a.parentData.hash),legacyBehavior:!0,children:(0,r.jsx)(U,{hash:a.parentData.hash,name:a.parentData.name,picture:a.parentData.picture})}),O?(0,r.jsx)("button",{onClick:es,children:(0,r.jsx)(j.JO,{name:"trash",color:"error"})}):(0,r.jsx)(r.Fragment,{})]}):(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{}),(0,r.jsx)(B,{className:"fs-10",children:!O&&q?(0,r.jsx)(j.zx,{color:"main2",size:"regular",kind:"neon",variant:"text-only",onClick:el,children:(0,r.jsxs)("div",{children:[(0,r.jsx)(W,{name:"link"})," link now"]})}):(0,r.jsx)(r.Fragment,{children:"not linked"})})]})})}),(0,r.jsx)("div",{children:(0,r.jsxs)(k.ZP,{title:"DECENTRALIZED SCORE",children:[(0,r.jsxs)(Y,{className:er&&"text-".concat(er.color),children:[(0,r.jsx)(E.Z,{decentralization:(null==a?void 0:null===(i=a.scoreData)||void 0===i?void 0:i.decentralization)||0}),!!er&&(0,r.jsx)(j.JO,{name:"hexagon-exclamation",color:er.color})]}),!!er&&(0,r.jsxs)("p",{className:"tp-body3 fs-10",children:["There are ",l," nodes on this ASN. Please consider to migrate your node to a different ASN."]})]})}),(0,r.jsx)("div",{children:(0,r.jsx)(k.ZP,{title:"PERFORMANCE",children:(0,r.jsx)(k.HC,{name:"CREATION TIME",value:K})})})]})}),(0,r.jsx)(I.Z,{show:!a,center:!0})]})};R.displayName="ComputeResourceNodeDetailPage";var O=(0,t.memo)(R),A=(0,a.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-b9jk28-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),z=(0,a.ZP)("section").withConfig({displayName:"cmp___StyledSection2",componentId:"sc-b9jk28-1"})({marginTop:"2rem"}),T=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-b9jk28-2"})({display:"flex",alignItems:"center",gap:"0.75rem"}),H=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-b9jk28-3"})({display:"inline-flex",alignItems:"center",gap:"0.5rem"}),M=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-b9jk28-4"})({whiteSpace:"nowrap"}),L=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-b9jk28-5"})({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),F=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-b9jk28-6"})({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),B=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-b9jk28-7"})({lineHeight:"1rem"}),W=(0,a.ZP)(j.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-b9jk28-8"})({height:"0.875rem",width:"0.875rem"}),J=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-b9jk28-9"})({display:"flex",alignItems:"center"}),U=(0,a.ZP)(S.Z).withConfig({displayName:"cmp___StyledNodeName",componentId:"sc-b9jk28-10"})({marginRight:"auto",width:"auto",cursor:"pointer"}),Y=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv8",componentId:"sc-b9jk28-11"})({display:"flex",alignItems:"center",gap:"0.75rem"}),q=O}},function(e){e.O(0,[959,312,987,154,774,888,179],function(){return e(e.s=70805)}),_N_E=e.O()}]);